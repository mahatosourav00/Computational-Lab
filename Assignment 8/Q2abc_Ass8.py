
import matplotlib.pyplot as plt
import my_library as ml
steps = []
V = []
error = []
analyt_val = 12.56637
def fun(x,y,z):
    return ((x**2)/(1**2))+((y**2)/(1.5**2))+((z**2)/(2**2))

print("{:<15}{:<20}{:<15}".format("Steps", "Volume of ellipsoid", "Fractional error"))
N = 40000
i = 0
while i < N:
    i = i+100
    Fn, X1, Y1, Z1, frac_err  = ml.monte_carlo_volume(-1,1,-1.5,1.5,-2,2,fun,i, analyt_val)

    steps.append(i)
    V.append(Fn)
    error.append(frac_err)
    print("{:<15}{:<20}{:<15}".format(i, Fn, frac_err))

sum_ans = 0
sum_err = 0
for i in range(len(V)):
    sum_ans = sum_ans + V[i]
    sum_err = sum_err + error[i]
print("\nVolume = ", sum_ans/len(V))
print("\nFractional Error =", sum_err/len(error))


plt.figure()
plt.plot(steps, V)
plt.axhline(12.56637, color='r')

plt.text(30000, 12.6, "Analytical value = 12.56637", size=16,
         va="baseline", ha="left", multialignment="left")
plt.title("Plot for Steps vs Volume of ellipsoid")
plt.xlabel("Steps")
plt.ylabel("Volume of ellipsoid")

plt.figure()
plt.plot(steps,error)

plt.title("Plot for Steps vs Fractional error")
plt.xlabel("Steps")
plt.ylabel("Fractional Error")
plt.show()


'''

Steps          Volume of ellipsoid Fractional error
100            12.959999999999999  0.03132408165603909
200            12.84               0.02177478460366842
300            12.48               0.006873106553443734
400            12.66               0.0074508390251123435
500            12.768              0.016045206372246046
600            12.36               0.016422403605814546
700            12.72               0.012225487551297749
800            13.11               0.043260702971502536
900            12.906666666666668  0.027079949632763393
1000           12.816              0.01986492519319434
1100           12.392727272727274  0.013818049864258716
1200           12.280000000000001  0.022788601640728233
1300           12.258461538461539  0.024502578034743542
1400           12.377142857142857  0.015058218312618676
1500           12.704              0.010952247944314984
1600           12.87               0.024162108866761053
1700           12.988235294117647  0.0335709750801264
1800           12.973333333333334  0.03238511466185823
1900           12.593684210526316  0.002173595917223262
2000           12.336              0.018332263016288625
2100           12.537142857142857  0.00232582224279102
2200           12.370909090909091  0.015554285691962603
2300           12.187826086956523  0.03012356894182457
2400           12.85               0.022570559358032632
2500           13.0848             0.04125535059050469
2600           12.48               0.006873106553443734
2700           12.622222222222222  0.004444578841958548
2800           12.120000000000001  0.03552099771055589
2900           12.728275862068966  0.012884059761806028
3000           12.48               0.006873106553443734
3100           12.541935483870967  0.0019444371070589397
3200           12.615              0.003869852630473324
3300           12.850909090909092  0.022642902517520363
3400           12.84               0.02177478460366842
3500           12.507428571428571  0.004690410084330482
3600           12.513333333333334  0.004220524038896317
3700           12.395675675675674  0.013583423401055743
3800           12.385263157894737  0.014412025278999563
3900           12.252307692307692  0.024992285575890814
4000           12.66               0.0074508390251123435
4100           12.866341463414635  0.02387097176150597
4200           12.874285714285714  0.02450315519006002
4300           12.586046511627908  0.0015658071207443765
4400           12.46909090909091   0.007741224467295536
4500           12.746666666666666  0.014347553562935598
4600           12.589565217391305  0.001845816842199151
4700           12.674042553191489  0.008568309956772715
4800           12.450000000000001  0.009260430816536366
4900           12.465306122448979  0.00804240823332595
5000           12.6336             0.005349993673590731
5100           12.865882352941176  0.02383443690908168
5200           12.710769230769232  0.011490926239576984
5300           12.36679245283019   0.01588187735756703
5400           12.484444444444444  0.0065194288848374965
5500           12.554181818181819  0.0009699047392508859
5600           12.450000000000001  0.009260430816536366
5700           12.378947368421052  0.01491461986070338
5800           12.463448275862069  0.008190250974460432
5900           12.463728813559323  0.00816792649274822
6000           12.304              0.020878742230254155
6100           12.39344262295082   0.013761124099416065
6200           12.87483870967742   0.024547161167259947
6300           12.681904761904763  0.009193964677529273
6400           12.3825             0.014631910408494965
6500           12.550153846153846  0.001290440584365541
6600           12.585454545454546  0.0015186999471244872
6700           12.594626865671643  0.0022486100338955117
6800           12.66               0.0074508390251123435
6900           12.525217391304349  0.003274820707622856
7000           12.356571428571428  0.01669524066445372
7100           12.672676056338029  0.008459567586982507
7200           12.243333333333334  0.025706442406730434
7300           12.64109589041096   0.00594649770864299
7400           12.817297297297296  0.0199681608370036
7500           12.745600000000001  0.01426267092247023
7600           12.783157894736842  0.01725143336833492
7700           12.52051948051948   0.003648668587708206
7800           12.670769230769231  0.008307827222119998
7900           12.710886075949366  0.01150022448402897
8000           12.627              0.004824782335710433
8100           12.622222222222222  0.004444578841958548
8200           12.64390243902439   0.006169835761989474
8300           12.650602409638555  0.006703002508962895
8400           12.668571428571429  0.008132931671710279
8500           12.477176470588237  0.007097795895852366
8600           12.527441860465116  0.0030978030676228297
8700           12.204137931034483  0.02882551357038799
8800           12.466363636363637  0.007958253945758591
8900           12.757752808988764  0.015229760781257023
9000           12.458666666666666  0.008570759362754182
9100           12.593406593406593  0.0021515038476977778
9200           12.401739130434784  0.013100908978902837
9300           12.521290322580645  0.0035873269225204906
9400           12.551489361702126  0.001184163628627281
9500           12.487578947368421  0.006269993055399295
9600           12.4825             0.006674162864852716
9700           12.395876288659792  0.013567459126239858
9800           12.433469387755101  0.010575895206403894
9900           12.688484848484848  0.009717591355725516
10000          12.575999999999999  0.0007663310884527182
10100          12.617821782178218  0.004094402932447415
10200          12.334117647058822  0.018482055911227948
10300          12.631456310679612  0.00517940428935426
10400          12.696923076923078  0.010389084271995691
10500          12.736              0.013498727158280514
10600          12.747169811320756  0.01438759254428739
10700          12.448598130841122  0.00937198802509218
10800          12.462222222222222  0.008287817227869107
10900          12.742018348623855  0.01397765214806311
11000          12.556363636363637  0.0007962811564805538
11100          12.672432432432432  0.008440180611619158
11200          12.499285714285715  0.005338398098598379
11300          12.828318584070797  0.020845207014499604
11400          12.538947368421052  0.0021822237908757243
11500          12.828521739130434  0.020861373581267658
11600          12.353793103448277  0.016916332763695648
11700          12.662564102564103  0.007654883833923683
11800          12.40677966101695   0.01269979628031399
11900          12.496134453781512  0.005589167453965434
12000          12.536              0.002416767929004125
12100          12.4700826446281    0.007662304656945423
12200          12.55672131147541   0.0007678182740591577
12300          12.550243902439025  0.0012832741325437874
12400          12.43741935483871   0.010261566797833377
12500          12.6432             0.006113937437780446
12600          12.396190476190476  0.013542456875734438
12700          12.651968503937008  0.006811712844441842
12800          12.511875           0.004336574523907803
12900          12.548837209302325  0.0013952152210760676
13000          12.694153846153846  0.010168715878479348
13100          12.685190839694656  0.009455462452136647
13200          12.66               0.0074508390251123435
13300          12.581052631578947  0.0011684067538157712
13400          12.587462686567164  0.0016785027471867557
13500          12.613333333333333  0.003737223504745932
13600          12.70764705882353   0.011242471678259631
13700          12.583357664233576  0.001351835433269663
13800          12.646956521739131  0.00641287195420254
13900          12.71136690647482   0.011538487763357384
14000          12.402857142857142  0.01301194037282501
14100          12.517446808510638  0.0038931840690160746
14200          12.625352112676056  0.004693647622667265
14300          12.557202797202796  0.0007295028554151067
14400          12.733333333333334  0.013286520557116745
14500          12.562758620689655  0.00028738444836052705
14600          12.529315068493151  0.0029487379017845267
14700          12.53061224489796   0.0028455118782941954
14800          12.585405405405405  0.0015147895060710313
14900          12.719999999999999  0.012225487551297608
15000          12.713600000000001  0.0117161917085047
15100          12.507019867549669  0.004722933707214578
15200          12.52421052631579   0.0033549444815177266
15300          12.633725490196078  0.005359979866586648
15400          12.484675324675324  0.006501056018935859
15500          12.70916129032258   0.011362970398180301
15600          12.53076923076923   0.0028330193389792353
15700          12.605350318471338  0.003101955335656888
15800          12.596962025316456  0.002434436143170771
15900          12.593207547169811  0.002135664250679562
16000          12.588000000000001  0.001721260793689969
16100          12.433788819875776  0.010550475604667311
16200          12.703703703703702  0.010928669433074408
16300          12.558036809815952  0.0006631342371780123
16400          12.545853658536585  0.00163263865885014
16500          12.580363636363636  0.0011135782539935237
16600          12.414939759036145  0.012050436280632721
16700          12.570538922155688  0.00033175230044067206
16800          12.53               0.00289423278162268
16900          12.589349112426035  0.001828619754633669
17000          12.712941176470588  0.011663764195275888
17100          12.572631578947368  0.0004982806448774438
17200          12.759069767441861  0.015334561010209174
17300          12.733872832369942  0.013329452528450346
17400          12.446896551724137  0.009507395395477129
17500          12.437485714285714  0.010256286080569436
17600          12.73909090909091   0.01374469390053858
17700          12.547796610169492  0.0014780234730083057
17800          12.74696629213483   0.014371397001268578
17900          12.659664804469275  0.007424165010999629
18000          12.664              0.007769148926857999
18100          12.624530386740332  0.004628256747201705
18200          12.474725274725275  0.00729285587442709
18300          12.654426229508196  0.007007292440712573
18400          12.62217391304348   0.004440734519473801
18500          12.439783783783783  0.010073411511535641
18600          12.654193548387097  0.006988776264513756
18700          12.565989304812835  3.0294761905351196e-05
18800          12.409787234042552  0.012460461211745877
18900          12.736507936507936  0.013539147463263975
19000          12.497684210526316  0.005465841724673331
19100          12.546596858638743  0.0015734966709762528
19200          12.5625             0.00030796482993888864
19300          12.72621761658031   0.012720269781990451
19400          12.585154639175256  0.0014948341625510674
19500          12.702769230769231  0.01085430643608553
19600          12.63673469387755   0.005599444698632192
19700          12.348426395939086  0.017343401798682778
19800          12.581818181818182  0.0012293273091738394
19900          12.555979899497489  0.0008268179675204881
20000          12.521999999999998  0.003530852585114133
20100          12.500298507462686  0.005257802574435828
20200          12.477623762376238  0.007062201544579788
20300          12.594679802955664  0.0022528226493143816
20400          12.52705882352941   0.0031282841799651693
20500          12.681365853658535  0.009151079719802637
20600          12.606990291262138  0.003232460230133166
20700          12.577391304347826  0.0008770475760164983
20800          12.676153846153847  0.008736321320623826
20900          12.586794258373207  0.0016253109190010715
21000          12.462857142857144  0.008237291846639462
21100          12.585781990521328  0.0015447571988831145
21200          12.607924528301888  0.0033068044552157063
21300          12.68169014084507   0.009176885675423472
21400          12.570841121495327  0.0003558005609677365
21500          12.676465116279068  0.008761091411367748
21600          12.48               0.006873106553443734
21700          12.602764976958525  0.002896220384926285
21800          12.526238532110092  0.00319356090023666
21900          12.72767123287671   0.012835944897111227
22000          12.497454545454547  0.005484117891280653
22100          12.521266968325794  0.0035891853951622943
22200          12.58918918918919   0.0018158934671819054
22300          12.520896860986548  0.003618637602859923
22400          12.560357142857143  0.0004784879915883725
22500          12.424533333333335  0.011287003857650588
22600          12.566017699115045  2.8035215018636968e-05
22700          12.495859030837003  0.005611084916566655
22800          12.562105263157894  0.00033937699129539485
22900          12.563842794759825  0.0002011086129227385
23000          12.581217391304346  0.0011815179168166111
23100          12.677402597402597  0.008835693792447485
23200          12.521379310344829  0.0035802455009020595
23300          12.643776824034335  0.006159839638203853
23400          12.532307692307691  0.002710592453692488
23500          12.60663829787234   0.003204449484802788
23600          12.550169491525423  0.0012891955651931123
23700          12.5873417721519    0.001668880683276152
23800          12.635294117647058  0.005484807279035967
23900          12.520167364016737  0.0036766891300559898
24000          12.488              0.006236486749952422
24100          12.541742738589212  0.0019597752899832626
24200          12.633719008264464  0.00535946405083288
24300          12.486913580246913  0.0063229412911673015
24400          12.647213114754098  0.006433290978548247
24500          12.60734693877551   0.0032608413388680447
24600          12.510243902439024  0.004466373150000772
24700          12.571336032388665  0.000395184320425513
24800          12.447096774193549  0.00949146219683573
24900          12.670843373493975  0.00831372731297708
25000          12.53664            0.0023658383447247634
25100          12.653067729083666  0.006899186406549167
25200          12.632380952380952  0.00525298494163017
25300          12.550197628458498  0.0012869564990924788
25400          12.534803149606299  0.002512010261809903
25500          12.464              0.008146346160426499
25600          12.601875           0.0028253982653702356
25700          12.549105058365758  0.0013739004688101367
25800          12.648372093023257  0.0065255195432935426
25900          12.638455598455598  0.005736389940420285
26000          12.590769230769231  0.0019416291872061708
26100          12.466206896551723  0.007970726904291053
26200          12.62473282442748   0.004644366227278175
26300          12.551178707224334  0.0012088847277029705
26400          12.645454545454545  0.006293348473309752
26500          12.55788679245283   0.0006750722402069018
26600          12.631578947368421  0.005189163407445594
26700          12.540224719101124  0.0020805754485086272
26800          12.560597014925373  0.00045939957797093726
26900          12.693234200743493  0.010095532818426813
27000          12.51377777777778   0.004185156272035594
27100          12.519852398523986  0.003701753288818775
27200          12.622058823529413  0.004431575986495186
27300          12.496703296703297  0.005543900370329892
27400          12.636788321167883  0.005603712223011379
27500          12.703418181818183  0.010905948322242913
27600          12.49304347826087   0.00583513948253393
27700          12.448808664259928  0.009355234307128524
27800          12.530071942446044  0.0028885077833897045
27900          12.559139784946236  0.0005753622608408864
28000          12.506571428571428  0.0047586193489902754
28100          12.592740213523133  0.0020984750188903717
28200          12.395744680851063  0.01357793214340625
28300          12.47321554770318   0.007412996139443519
28400          12.607605633802818  0.0032814276360491204
28500          12.48               0.006873106553443734
28600          12.485874125874126  0.006405658445985039
28700          12.494216027874565  0.005741830944452098
28800          12.515              0.004087894913168925
28900          12.521522491349481  0.0035688515180213546
29000          12.500689655172414  0.005226676027172967
29100          12.602061855670105  0.002840267767868156
29200          12.456164383561644  0.008769884735079036
29300          12.60532423208191   0.0030998794466430162
29400          12.442448979591838  0.009861321957586922
29500          12.600406779661016  0.0027085609974095174
29600          12.668918918918918  0.008160584076301937
29700          12.603636363636364  0.002965563136877585
29800          12.43731543624161   0.010269836377441482
29900          12.496856187290971  0.005531733723344753
30000          12.568000000000001  0.00012971128496154743
30100          12.629102990033223  0.004992132973422226
30200          12.359205298013245  0.01648564398364474
30300          12.670891089108911  0.008317524401152628
30400          12.485526315789473  0.006433336294453071
30500          12.598032786885245  0.0025196446456093296
30600          12.710588235294118  0.01147652307660198
30700          12.626970684039089  0.004822449445551051
30800          12.575064935064935  0.000691920981551228
30900          12.58873786407767   0.0017799781542060893
31000          12.635612903225805  0.00551017543059819
31100          12.611189710610931  0.0035666394202090394
31200          12.51               0.0044857822903511015
31300          12.575846645367413  0.0007541275139450768
31400          12.62216560509554   0.004440073393950798
31500          12.491428571428571  0.005963649691313248
31600          12.555949367088607  0.0008292476595383156
31700          12.54738170347003   0.0015110407006931046
31800          12.650566037735848  0.006700108124768617
31900          12.567272727272726  7.183675737124824e-05
32000          12.62175            0.004407000589669198
32100          12.446355140186915  0.009550479558781425
32200          12.559006211180124  0.0005859917239326061
32300          12.51938080495356   0.0037392815145853094
32400          12.592592592592592  0.002086727717916353
32500          12.525784615384614  0.003229682447308568
32600          12.60515337423313   0.003086283010378516
32700          12.645871559633028  0.006326533408854618
32800          12.553902439024391  0.0009921370272885641
32900          12.554407294832826  0.0009519618765938873
33000          12.578181818181818  0.0009399546712231916
33100          12.548882175226586  0.0013916369463427508
33200          12.532048192771084  0.0027312427716926282
33300          12.634954954954955  0.005457817568236136
33400          12.589221556886228  0.001818469206797895
33500          12.581014925373136  0.001165406189149045
33600          12.647142857142857  0.0064277000552154405
33700          12.456498516320476  0.008743295293670579
33800          12.639053254437869  0.005783949894668826
33900          12.658407079646018  0.0073240784447711664
34000          12.637411764705883  0.005653324285842582
34100          12.59542521994135   0.002312141051182647
34200          12.547368421052632  0.0015120976819373972
34300          12.545772594752187  0.001639089510161854
34400          12.621627906976745  0.0043972847351100896
34500          12.474434782608697  0.007315972503698572
34600          12.570867052023122  0.0003578640469063421
34700          12.660518731988473  0.007492118407183137
34800          12.58206896551724   0.0012492840428255498
34900          12.50131805157593   0.005176669827807759
35000          12.5184             0.003817331496685153
35100          12.655042735042736  0.00705635239474381
35200          12.555681818181819  0.0008505385260962473
35300          12.552067988668554  0.001138117955419499
35400          12.584406779661018  0.0014353213904268933
35500          12.578028169014084  0.0009277276583520235
35600          12.542696629213482  0.0018838670822613577
35700          12.516974789915967  0.003930746117139036
35800          12.520893854748604  0.0036188768316861315
35900          12.552869080779944  0.001074369067603075
36000          12.592666666666666  0.002092622345726497
36100          12.498614958448755  0.005391775154737943
36200          12.492596685082873  0.005870694155681096
36300          12.650578512396695  0.00670110082678578
36400          12.513626373626373  0.004197204632175106
36500          12.569424657534247  0.00024308193489830802
36600          12.58688524590164   0.0016325514768099302
36700          12.556512261580382  0.0007844539369457716
36800          12.671739130434784  0.00838500938893128
36900          12.670569105691056  0.008291901773627323
37000          12.561729729729729  0.00036926099345080274
37100          12.61067385444744   0.003525588889030016
37200          12.625806451612902  0.0047298027682539465
37300          12.505093833780162  0.004876202612197265
37400          12.446631016042781  0.009528526054637722
37500          12.544640000000001  0.00172921854123331
37600          12.55595744680851   0.0008286046958262086
37700          12.628328912466843  0.004930533834897751
37800          12.570158730158731  0.0003014975811417158
37900          12.536358839050132  0.0023882124233065537
38000          12.654315789473685  0.00699850390157905
38100          12.513385826771653  0.004216346743597858
38200          12.64523560209424   0.006275925513433199
38300          12.578381201044387  0.0009558210560716879
38400          12.455625           0.008812807517206611
38500          12.60903896103896   0.0033954881989756176
38600          12.499274611398963  0.005339281638296177
38700          12.592868217054264  0.00210866121674473
38800          12.504123711340204  0.004953402506833299
38900          12.58426735218509   0.0014242261038861154
39000          12.638769230769231  0.005761348008154467
39100          12.635907928388745  0.005533652788255148
39200          12.65265306122449   0.006866188185171236
39300          12.572824427480917  0.0005136270443189208
39400          12.495837563451778  0.005612793236887154
39500          12.493974683544305  0.005761036516965031
39600          12.558787878787879  0.0006033660645135024
39700          12.617229219143576  0.004047248262113646
39800          12.570452261306533  0.0003248560488457771
39900          12.646015037593985  0.006337951022768381
40000          12.6312             0.005159007732543337

Volume =  12.576633501981656

Fractional Error = 0.007196097808029649


'''