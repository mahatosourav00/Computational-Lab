
import matplotlib.pyplot as plt
import monte_carlo_volume as mcv
steps = []
V = []
error = []

def fun(x,y,z):
    return ((x**2)/(1**2))+((y**2)/(1.5**2))+((z**2)/(2**2))

print("{:<15}{:<20}".format("Steps", "Volume of ellipsoid"))
N = 40000
i = 0
while i < N:
    i = i+100
    Fn, X1, X2, Y1, Y2, Z1, Z2, frac_err  = mcv.monte_carlo_volume(-1,1,-1.5,1.5,-2,2,fun,i)

    steps.append(i)
    V.append(Fn)
    error.append(frac_err)
    print("{:<15}{:<20}".format(i, Fn))

sum_ans = 0
sum_err = 0
for i in range(len(V)):
    sum_ans = sum_ans + V[i]
    sum_err = sum_err + error[i]
print("\nVolume = ", sum_ans/len(V))
print("\nFractional Error =", sum_err/len(error))


plt.figure()
plt.plot(steps, V)
plt.axhline(12.57, color='r')

plt.text(30000, 12.6, "Analytical value = 12.57", size=16,
         va="baseline", ha="left", multialignment="left")
plt.title("Plot for Steps vs Volume of ellipsoid")
plt.xlabel("Steps")
plt.ylabel("Volume of ellipsoid")

plt.figure()
plt.plot(steps,error)

plt.title("Plot for Steps vs Fractional error")
plt.xlabel("Steps")
plt.ylabel("Fractional Error")
plt.show()


'''

Steps          Volume of ellipsoid 
100            12.0                
200            12.48               
300            12.0                
400            13.02               
500            12.144              
600            12.52               
700            12.205714285714286  
800            12.09               
900            12.586666666666668  
1000           12.624              
1100           12.218181818181819  
1200           12.620000000000001  
1300           12.221538461538463  
1400           12.702857142857143  
1500           12.272              
1600           12.405              
1700           12.734117647058824  
1800           12.306666666666667  
1900           12.530526315789473  
2000           13.188              
2100           12.571428571428571  
2200           12.283636363636365  
2300           12.427826086956523  
2400           12.81               
2500           12.335999999999999  
2600           13.116923076923078  
2700           12.88888888888889   
2800           12.085714285714287  
2900           12.571034482758622  
3000           12.296              
3100           12.572903225806451  
3200           12.84               
3300           12.741818181818182  
3400           12.952941176470588  
3500           12.658285714285714  
3600           12.72               
3700           12.454054054054053  
3800           12.625263157894736  
3900           12.350769230769231  
4000           12.51               
4100           12.30439024390244   
4200           12.811428571428571  
4300           12.636279069767442  
4400           12.57818181818182   
4500           12.719999999999999  
4600           12.813913043478262  
4700           12.27063829787234   
4800           12.315              
4900           12.176326530612243  
5000           12.527999999999999  
5100           12.668235294117647  
5200           12.420000000000002  
5300           12.81056603773585   
5400           12.515555555555556  
5500           12.676363636363638  
5600           12.42               
5700           12.522105263157895  
5800           12.426206896551724  
5900           12.711864406779661  
6000           12.592              
6100           12.519344262295082  
6200           12.60774193548387   
6300           12.491428571428571  
6400           12.54375            
6500           12.528              
6600           12.738181818181818  
6700           12.834626865671641  
6800           12.416470588235294  
6900           12.316521739130435  
7000           12.617142857142856  
7100           12.476619718309859  
7200           12.573333333333334  
7300           12.756164383561645  
7400           12.739459459459459  
7500           12.416              
7600           12.281052631578946  
7700           12.364675324675325  
7800           12.695384615384615  
7900           12.726075949367088  
8000           12.543000000000001  
8100           12.687407407407406  
8200           12.655609756097562  
8300           12.575421686746989  
8400           12.48857142857143   
8500           12.573176470588237  
8600           12.493953488372092  
8700           12.697931034482759  
8800           12.534545454545455  
8900           12.61752808988764   
9000           12.528              
9100           12.793846153846154  
9200           12.513913043478261  
9300           12.580645161290322  
9400           12.490212765957446  
9500           12.538105263157895  
9600           12.5225             
9700           12.722474226804122  
9800           12.651428571428571  
9900           12.562424242424242  
10000          12.736799999999999  
10100          12.43009900990099   
10200          12.475294117647058  
10300          12.729320388349516  
10400          12.786923076923078  
10500          12.377142857142857  
10600          12.697358490566039  
10700          12.462056074766355  
10800          12.502222222222223  
10900          12.634128440366974  
11000          12.523636363636363  
11100          12.248648648648649  
11200          12.53357142857143   
11300          12.554336283185842  
11400          12.541052631578948  
11500          12.59895652173913   
11600          12.66               
11700          12.77948717948718   
11800          12.439322033898305  
11900          12.641344537815126  
12000          12.624              
12100          12.398677685950414  
12200          12.289180327868852  
12300          12.597073170731708  
12400          12.690967741935484  
12500          12.249600000000001  
12600          12.49904761904762   
12700          12.483779527559054  
12800          12.55875            
12900          12.768372093023256  
13000          12.71076923076923   
13100          12.58442748091603   
13200          12.634545454545455  
13300          12.489022556390978  
13400          12.671641791044776  
13500          12.426666666666668  
13600          12.584117647058823  
13700          12.625401459854015  
13800          12.438260869565218  
13900          12.574964028776979  
14000          12.668571428571427  
14100          12.56340425531915   
14200          12.566197183098593  
14300          12.617622377622377  
14400          12.715000000000002  
14500          12.428689655172413  
14600          12.5013698630137    
14700          12.445714285714287  
14800          12.614594594594594  
14900          12.555704697986577  
15000          12.568000000000001  
15100          12.514966887417218  
15200          12.721578947368421  
15300          12.574117647058824  
15400          12.6                
15500          12.459870967741935  
15600          12.53076923076923   
15700          12.590063694267515  
15800          12.596962025316456  
15900          12.55245283018868   
16000          12.498000000000001  
16100          12.575403726708075  
16200          12.58222222222222   
16300          12.562453987730063  
16400          12.46829268292683   
16500          12.634181818181817  
16600          12.540722891566265  
16700          12.602155688622755  
16800          12.558571428571428  
16900          12.484260355029585  
17000          12.625411764705882  
17100          12.520701754385964  
17200          12.605581395348837  
17300          12.56878612716763   
17400          12.557241379310344  
17500          12.523885714285713  
17600          12.540000000000001  
17700          12.752542372881356  
17800          12.7038202247191    
17900          12.475977653631285  
18000          12.430666666666665  
18100          12.470718232044199  
18200          12.474725274725275  
18300          12.494426229508196  
18400          12.512608695652174  
18500          12.636972972972972  
18600          12.578064516129032  
18700          12.587807486631016  
18800          12.529787234042553  
18900          12.652698412698413  
19000          12.601263157894737  
19100          12.620732984293193  
19200          12.405000000000001  
19300          12.671502590673574  
19400          12.572783505154637  
19500          12.521846153846154  
19600          12.634285714285713  
19700          12.646903553299493  
19800          12.549090909090909  
19900          12.435376884422112  
20000          12.707999999999998  
20100          12.538507462686567  
20200          12.567920792079208  
20300          12.58167487684729   
20400          12.52470588235294   
20500          12.584195121951218  
20600          12.586019417475729  
20700          12.49391304347826   
20800          12.568846153846154  
20900          12.54775119617225   
21000          12.624              
21100          12.603981042654029  
21200          12.459622641509435  
21300          12.697464788732395  
21400          12.505794392523365  
21500          12.497860465116279  
21600          12.527777777777779  
21700          12.464516129032258  
21800          12.594495412844038  
21900          12.55890410958904   
22000          12.379636363636363  
22100          12.536470588235295  
22200          12.551351351351352  
22300          12.577937219730943  
22400          12.477857142857143  
22500          12.5664             
22600          12.495929203539824  
22700          12.501145374449338  
22800          12.57157894736842   
22900          12.578515283842794  
23000          12.66886956521739   
23100          12.554805194805194  
23200          12.514137931034483  
23300          12.50884120171674   
23400          12.557948717948719  
23500          12.496340425531914  
23600          12.429152542372881  
23700          12.649113924050633  
23800          12.671596638655462  
23900          12.481004184100419  
24000          12.58               
24100          12.490954356846473  
24200          12.467107438016528  
24300          12.59753086419753   
24400          12.578360655737704  
24500          12.6014693877551    
24600          12.638048780487805  
24700          12.551902834008098  
24800          12.522580645161291  
24900          12.556144578313253  
25000          12.548160000000001  
25100          12.614820717131474  
25200          12.664761904761905  
25300          12.567272727272726  
25400          12.56220472440945   
25500          12.592941176470589  
25600          12.598125           
25700          12.576186770428015  
25800          12.605581395348837  
25900          12.529111969111968  
26000          12.753230769230768  
26100          12.50022988505747   
26200          12.543206106870228  
26300          12.626920152091255  
26400          12.495454545454546  
26500          12.512603773584905  
26600          12.578345864661655  
26700          12.525842696629214  
26800          12.638507462686567  
26900          12.557620817843866  
27000          12.558222222222224  
27100          12.62258302583026   
27200          12.573529411764707  
27300          12.427252747252748  
27400          12.610510948905109  
27500          12.581236363636364  
27600          12.646956521739131  
27700          12.625559566787004  
27800          12.619856115107915  
27900          12.608172043010752  
28000          12.452571428571428  
28100          12.648256227758008  
28200          12.514893617021276  
28300          12.526643109540636  
28400          12.519718309859156  
28500          12.510315789473685  
28600          12.479160839160839  
28700          12.573658536585366  
28800          12.527500000000002  
28900          12.513217993079586  
29000          12.557793103448276  
29100          12.534432989690723  
29200          12.654246575342466  
29300          12.47344709897611   
29400          12.618775510204083  
29500          12.632135593220339  
29600          12.618648648648648  
29700          12.586666666666666  
29800          12.55248322147651   
29900          12.567491638795987  
30000          12.5808             
30100          12.49594684385382   
30200          12.429933774834437  
30300          12.607524752475248  
30400          12.568421052631578  
30500          12.69167213114754   
30600          12.48313725490196   
30700          12.600390879478827  
30800          12.57974025974026   
30900          12.530485436893205  
31000          12.529548387096774  
31100          12.568745980707394  
31200          12.563846153846153  
31300          12.528306709265175  
31400          12.644331210191082  
31500          12.538666666666668  
31600          12.581772151898734  
31700          12.607192429022081  
31800          12.591698113207547  
31900          12.619937304075235  
32000          12.468              
32100          12.477009345794391  
32200          12.538136645962734  
32300          12.573622291021671  
32400          12.588888888888889  
32500          12.570092307692308  
32600          12.520490797546014  
32700          12.596697247706421  
32800          12.524634146341464  
32900          12.536170212765956  
33000          12.488727272727273  
33100          12.633716012084593  
33200          12.53566265060241   
33300          12.615495495495496  
33400          12.619401197604791  
33500          12.50292537313433   
33600          12.665714285714285  
33700          12.570445103857567  
33800          12.499881656804734  
33900          12.64353982300885   
34000          12.592235294117648  
34100          12.522932551319649  
34200          12.699649122807017  
34300          12.519883381924199  
34400          12.535813953488372  
34500          12.476521739130435  
34600          12.561849710982658  
34700          12.623170028818443  
34800          12.532413793103448  
34900          12.497191977077364  
35000          12.680914285714286  
35100          12.525128205128205  
35200          12.613636363636365  
35300          12.558186968838527  
35400          12.553898305084747  
35500          12.471887323943662  
35600          12.451011235955056  
35700          12.61781512605042   
35800          12.58659217877095   
35900          12.653816155988858  
36000          12.604666666666667  
36100          12.526537396121885  
36200          12.598011049723757  
36300          12.494545454545456  
36400          12.567692307692308  
36500          12.64109589041096   
36600          12.705573770491803  
36700          12.534277929155314  
36800          12.50804347826087   
36900          12.575609756097561  
37000          12.498162162162162  
37100          12.510404312668463  
37200          12.676129032258064  
37300          12.478713136729223  
37400          12.611550802139037  
37500          12.577280000000002  
37600          12.680425531914892  
37700          12.592679045092838  
37800          12.52063492063492   
37900          12.606015831134565  
38000          12.622736842105263  
38100          12.503937007874015  
38200          12.527748691099475  
38300          12.577754569190601  
38400          12.64375            
38500          12.607168831168831  
38600          12.616787564766838  
38700          12.56               
38800          12.529484536082473  
38900          12.621902313624679  
39000          12.628307692307693  
39100          12.469565217391303  
39200          12.53204081632653   
39300          12.454351145038169  
39400          12.55248730964467   
39500          12.549265822784811  
39600          12.652121212121212  
39700          12.658337531486145  
39800          12.647638190954774  
39900          12.631578947368421  
40000          12.524999999999999  

Volume =  12.558945560228436

Fractional Error = 0.006918280630120167


'''